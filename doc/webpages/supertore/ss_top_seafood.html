<!DOCTYPE html>
<html>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <meta http-equiv='Cache-Control' content='no-cache, no-store, must-revalidate'>
  <meta http-equiv='Pragma' content='no-cache'>
  <meta http-equiv='Expires' content='0'>
  <title>Discounted Items - ss_seafood</title>
  <!-- Include Chart.js from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel='preconnect' href='https://fonts.googleapis.com'>
  <link rel='preconnect' href='https://fonts.gstatic.com' crossorigin>
  <link href='https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap' rel='stylesheet'>

  <style>
    html {
        overflow-y: scroll;
    }
    body {
        margin: 0;
        padding: 0;
        font-family: 'Montserrat', Arial, sans-serif;
        background-color: #fff;
        overflow-x: hidden;
        transition: opacity 0.5s ease;
    }
    /* Fade classes */
    .fade-in {
        opacity: 1;
        transition: opacity 0.5s ease;
    }
    .fade-out {
        opacity: 0;
        transition: opacity 0.5s ease;
    }
    .header-container {
        position: fixed;
        top: 0; left: 0; right: 0;
        background: #fff;
        padding: 10px 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        z-index: 1000;
    }
    .header-row {
        display: flex;
        align-items: center;
        gap: 20px;
    }
    .page-title {
        font-size: 22px;
        font-weight: 600;
    }
    .creation-time {
        text-align: center;
        font-size: 12px;
        color: gray;
        margin-top: 5px;
    }
    .divider {
        border: 0; height: 1px; background: #ccc;
        margin: 0 20px 10px;
    }
    .header-spacer {
        height: 70px;
    }
    .search-button {
        background-color: #3e7d53;
        border: none;
        color: #fff;
        padding: 6px 12px;
        border-radius: 9999px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    #searchBarContainer {
        position: fixed;
        top: 20px; left: 50%;
        transform: translateX(-50%);
        width: 240px;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 20px;
        padding: 8px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        text-align: center;
        transition: opacity 0.5s ease;
        opacity: 0;
        display: none;
        align-items: center;
        z-index: 1001;
    }
    #searchInput {
        padding: 4px;
        width: calc(100% - 60px);
        border: none;
        outline: none;
        font-size: 12px;
        flex-grow: 1;
    }
    #searchCount {
        font-size: 12px;
        color: #3e7d53;
        margin-left: 8px;
        white-space: nowrap;
    }
    #closeSearchButton {
        background: none;
        border: none;
        font-size: 16px;
        cursor: pointer;
        color: #3e7d53;
        margin-left: 8px;
        line-height: 1;
        padding: 0;
    }
    .item-container {
        display: flex;
        align-items: flex-start;
        gap: 15px;
        width: 90%;
        max-width: 600px;
        margin: 10px auto;
        border-bottom: 1px solid #ccc;
        padding-bottom: 10px;
    }
    .left-side {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }
    .item-image img {
        width: 80px;
        height: auto;
    }
    .vertical-switch-button {
        background-color: #3e7d53;
        border: none;
        color: #fff;
        padding: 6px 12px;
        border-radius: 9999px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        transition: opacity 0.5s ease;
    }
    .vertical-switch-button.selected {
        background-color: #3e7d53;
        color: #fff;
    }
    .vertical-switch-button:not(.selected) {
        background-color: #ddd;
        color: #000;
    }
    .toggle-switch {
        width: 80px;
        height: 28px;
        position: relative;
    }
    .toggle-switch.disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    /* Instead of display:none, hide the toggle input using opacity and absolute positioning */
    .toggle-input {
        opacity: 0;
        position: absolute;
        left: -9999px;
    }
    .toggle-label {
        display: inline-block;
        width: 100%;
        height: 100%;
        background-color: #ddd;
        border-radius: 9999px;
        position: relative;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .toggle-switch:not(.disabled) .toggle-label {
        background-color: #3e7d53;
    }
    .toggle-label .toggle-circle {
        position: absolute;
        top: 2px;
        left: 2px;
        width: 24px;
        height: 24px;
        background-color: #fff;
        border-radius: 50%;
        transition: transform 0.3s ease;
    }
    .toggle-input:checked + .toggle-label .toggle-circle {
        transform: translateX(52px);
    }
    .toggle-label .toggle-text {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        text-align: center;
        line-height: 28px;
        font-size: 12px;
        color: #fff;
        pointer-events: none;
    }
    .right-side {
        flex: 1;
        position: relative;
    }
    .view-container {
        width: 100%;
        height: 200px;
        position: relative;
        background-color: #f9f9f9;
    }
    .detail-view, .chart-view {
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        transition: opacity 0.5s ease;
    }
    .detail-view {
        background-color: #fff;
        display: flex;
        flex-direction: column;
        gap: 5px;
        opacity: 1;
        z-index: 2;
    }
    .chart-view {
        width: 100%;
        height: 100%;
        background-color: #f9f9f9;
        opacity: 0;
        z-index: 1;
    }
    .item-name {
        font-size: 14px;
        margin-bottom: 6px;
        font-weight: 600;
        color: black;
    }
    .item-number {
        color: red;
        font-weight: 600;
        border: 2px solid red;
        border-radius: 50%;
        display: inline-block;
        width: 22px;
        height: 22px;
        text-align: center;
        line-height: 20px;
        margin-right: 8px;
        font-size: 12px;
    }
    .now-price {
        color: red;
        font-weight: 600;
        font-size: 12px;
        margin: 4px 0;
    }
    .discount-badge {
        background-color: yellow;
        display: inline-block;
        font-weight: 600;
        padding: 2px 5px;
        font-size: 16px;
    }
    .was-price {
        text-decoration: line-through;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.body.classList.add('page-loaded');
    window.priceHistoryData = {"20720065_KG": {"1mon": [{"date": "02.19", "was_price": 29.79, "now_price": 20.47}, {"date": "03.05", "was_price": 29.79, "now_price": 20.47}], "1yr": [{"date": "02.19", "was_price": 29.79, "now_price": 20.47}, {"date": "03.05", "was_price": 29.79, "now_price": 20.47}]}, "20852143_KG": {"1mon": [{"date": "02.19", "was_price": 11.95, "now_price": 8.79}, {"date": "03.05", "was_price": 11.95, "now_price": 8.79}], "1yr": [{"date": "02.19", "was_price": 11.95, "now_price": 8.79}, {"date": "03.05", "was_price": 11.95, "now_price": 8.79}]}, "21043887_EA": {"1mon": [{"date": "02.05", "was_price": 9.49, "now_price": 5.99}, {"date": "03.12", "was_price": 9.49, "now_price": 7.0}], "1yr": [{"date": "02.05", "was_price": 9.49, "now_price": 5.99}, {"date": "03.12", "was_price": 9.49, "now_price": 7.0}]}, "21211819_EA": {"1mon": [{"date": "02.05", "was_price": 13.49, "now_price": 9.99}, {"date": "03.05", "was_price": 13.49, "now_price": 9.99}], "1yr": [{"date": "02.05", "was_price": 13.49, "now_price": 9.99}, {"date": "03.05", "was_price": 13.49, "now_price": 9.99}]}, "20750012_EA": {"1mon": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}], "1yr": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}]}, "20749901_EA": {"1mon": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}], "1yr": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}]}, "20749798_EA": {"1mon": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}], "1yr": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}]}, "20699832_EA": {"1mon": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}], "1yr": [{"date": "02.12", "was_price": 3.99, "now_price": 2.99}, {"date": "03.05", "was_price": 3.99, "now_price": 2.99}]}, "21108887_EA": {"1mon": [{"date": "02.05", "was_price": 10.99, "now_price": 9.99}, {"date": "03.05", "was_price": 10.99, "now_price": 9.99}], "1yr": [{"date": "02.05", "was_price": 10.99, "now_price": 9.99}, {"date": "03.05", "was_price": 10.99, "now_price": 9.99}]}};
});

/**
 * "Detail" button: shows the detail view (fade-in) and hides the chart view (fade-out),
 * and resets the toggle switch to disabled with label "1 Yr".
 */
function switchToDetail(btn) {
    var container = btn.closest('.item-container');
    var allButtons = container.querySelectorAll('.vertical-switch-button');
    allButtons.forEach(function(b) { b.classList.remove('selected'); });
    btn.classList.add('selected');

    var toggleSwitch = container.querySelector('.toggle-switch');
    toggleSwitch.classList.add('disabled');
    var toggleInput = container.querySelector('.toggle-input');
    toggleInput.checked = false;
    var toggleLabel = toggleSwitch.querySelector('.toggle-text');
    toggleLabel.textContent = "1 Yr";

    var detailView = container.querySelector('.detail-view');
    var chartView = container.querySelector('.chart-view');
    detailView.classList.add('fade-in');
    detailView.classList.remove('fade-out');
    chartView.classList.add('fade-out');
    chartView.classList.remove('fade-in');
    setTimeout(function() {
        chartView.innerHTML = '';
    }, 500);
}

/**
 * Toggle switch onchange: when the toggle changes, hide the detail view (fade-out) and show the chart view (fade-in).
 * If checked, render the 1 Yr (line) chart; if unchecked, render the 1 Mon (bar) chart.
 */
function toggleMonYr(checkbox) {
    var container = checkbox.closest('.item-container');
    var toggleSwitch = container.querySelector('.toggle-switch');
    if (toggleSwitch.classList.contains('disabled')) {
        toggleSwitch.classList.remove('disabled');
    }

    var detailBtn = container.querySelector('[data-type="detail"]');
    detailBtn.classList.remove('selected');

    var detailView = container.querySelector('.detail-view');
    var chartView = container.querySelector('.chart-view');
    detailView.classList.add('fade-out');
    detailView.classList.remove('fade-in');
    chartView.classList.add('fade-in');
    chartView.classList.remove('fade-out');

    var productId = container.getAttribute('data-product-id');
    var toggleLabel = checkbox.nextElementSibling.querySelector('.toggle-text');
    var data1mon = window.priceHistoryData[productId]["1mon"] || [];
    var data1yr  = window.priceHistoryData[productId]["1yr"]  || [];
    var filtered;
    if (checkbox.checked) {
        toggleLabel.textContent = "1 Yr";
        filtered = data1yr.filter(d => d.was_price > 0 && d.now_price > 0);
        renderChart(chartView, filtered, "1yr");
    } else {
        toggleLabel.textContent = "1 Mon";
        filtered = data1mon.filter(d => d.was_price > 0 && d.now_price > 0);
        renderChart(chartView, filtered, "1mon");
    }
}

/**
 * Renders a Chart.js chart inside the given chartView element.
 * mode: "1yr" for a two-line chart; "1mon" for a stacked bar chart.
 */
function renderChart(chartView, data, mode) {
    chartView.innerHTML = '';  // Clear previous content
    // Create a canvas element
    var canvas = document.createElement('canvas');
    canvas.id = 'chartCanvas-' + Date.now();
    chartView.appendChild(canvas);
    var ctx = canvas.getContext('2d');

    if(mode === "1yr") {
        // Prepare data for a line chart
        var labels = data.map(item => item.date);
        var wasPrices = data.map(item => item.was_price);
        var nowPrices = data.map(item => item.now_price);

        var config = {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Was Price',
                        data: wasPrices,
                        borderColor: 'rgba(0,119,204,1)',
                        backgroundColor: 'rgba(0,119,204,0.2)',
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Now Price',
                        data: nowPrices,
                        borderColor: 'rgba(0,153,0,1)',
                        backgroundColor: 'rgba(0,153,0,0.2)',
                        fill: false,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return "$ " + value;
                            }
                        }
                    }
                }
            }
        };
        new Chart(ctx, config);
    } else if(mode === "1mon") {
        // Prepare data for a stacked bar chart.
        // We'll show "Now Price" and the discount (difference between was and now)
        var labels = data.map(item => item.date);
        var nowPrices = data.map(item => item.now_price);
        var diff = data.map(item => item.was_price - item.now_price);

        var config = {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Now Price',
                        data: nowPrices,
                        backgroundColor: 'rgba(0,153,0,0.8)'
                    },
                    {
                        label: 'Discount',
                        data: diff,
                        backgroundColor: 'rgba(255,153,0,0.8)'
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    }
                },
                scales: {
                    x: {
                        stacked: true
                    },
                    y: {
                        stacked: true,
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return "$ " + value;
                            }
                        }
                    }
                }
            }
        };
        new Chart(ctx, config);
    }
}
</script>

</head>
<body>
<div class="header-container">
  <div class="header-row">
    <button class="search-button" onclick="showSearchBar()">
      <span class="search-icon">🔍</span> FIND ➜
    </button>
    <div class="page-title">ss_seafood</div>
  </div>
  <div class="creation-time">Created on: 2025-02-28 16:14:25</div>
</div>
<hr class="divider">
<div class="header-spacer"></div>

<div id="searchBarContainer">
  <input type="text" id="searchInput" placeholder="Search in page..." onkeyup="inPageSearch()">
  <span id="searchCount"></span>
  <button id="closeSearchButton" onclick="hideSearchBar()">×</button>
</div>


<div class="item-container" data-product-id="20720065_KG">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/20720065/b3/en/beauty/20720065_beauty_a06_@2.png' alt='Fresh Atlantic Salmon Fillets, Skin On, Packaged, Club Size' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="20720065_KG">
      <input type="checkbox" class="toggle-input" id="toggle-20720065_KG" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-20720065_KG">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#1</span>
            <span class="first-word">Fresh</span>
            <span class="product-name-text">Atlantic Salmon Fillets, Skin On, Packaged, Club Size</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 29.79</span></div>
          <div class="now-price">NOW: $ 20.47</div>
          <div class="discount-badge">31.3% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-20720065_KG">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="20852143_KG">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/20852143/b3/en/angle/20852143_angle_a06_@2.png' alt='Fresh Atlantic Salmon Fillets, Skin On, Packaged' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="20852143_KG">
      <input type="checkbox" class="toggle-input" id="toggle-20852143_KG" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-20852143_KG">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#2</span>
            <span class="first-word">Fresh</span>
            <span class="product-name-text">Atlantic Salmon Fillets, Skin On, Packaged</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 11.95</span></div>
          <div class="now-price">NOW: $ 8.79</div>
          <div class="discount-badge">26.4% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-20852143_KG">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="21043887_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/21043887/b3/en/angle/21043887_angle_a06_@2.png' alt='Pacific White Shrimp Raw 16-20/LB' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="21043887_EA">
      <input type="checkbox" class="toggle-input" id="toggle-21043887_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-21043887_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#3</span>
            <span class="first-word">Pacific</span>
            <span class="product-name-text">White Shrimp Raw 16-20/LB</span>
          </div>
          <div>Expire On: 2025-03-12</div>
          <div>WAS: <span class="was-price">$ 9.49</span></div>
          <div class="now-price">NOW: $ 7.00</div>
          <div class="discount-badge">26.2% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-21043887_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="21211819_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/21211819/b3/en/front/21211819_front_a06_@2.png' alt='Wild Yellowfin Tuna Skinless Boneless Steaks, Sustainably Sourced 280g' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="21211819_EA">
      <input type="checkbox" class="toggle-input" id="toggle-21211819_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-21211819_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#4</span>
            <span class="first-word">Wild</span>
            <span class="product-name-text">Yellowfin Tuna Skinless Boneless Steaks, Sustainably Sourced 280g</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 13.49</span></div>
          <div class="now-price">NOW: $ 9.99</div>
          <div class="discount-badge">25.9% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-21211819_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="20750012_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/20750012/b3/en/angle/20750012_angle_a06_@2.png' alt='Crab Flavoured Wild Alaska Pollock Chunks' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="20750012_EA">
      <input type="checkbox" class="toggle-input" id="toggle-20750012_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-20750012_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#5</span>
            <span class="first-word">Crab</span>
            <span class="product-name-text">Flavoured Wild Alaska Pollock Chunks</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 3.99</span></div>
          <div class="now-price">NOW: $ 2.99</div>
          <div class="discount-badge">25.1% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-20750012_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="20749901_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/20749901/b3/en/front/20749901_front_a06_@2.png' alt='Lobster Flavoured Wild Alaska Pollock Chunks' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="20749901_EA">
      <input type="checkbox" class="toggle-input" id="toggle-20749901_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-20749901_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#6</span>
            <span class="first-word">Lobster</span>
            <span class="product-name-text">Flavoured Wild Alaska Pollock Chunks</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 3.99</span></div>
          <div class="now-price">NOW: $ 2.99</div>
          <div class="discount-badge">25.1% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-20749901_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="20749798_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/20749798/b3/en/angle/20749798_angle_a06_@2.png' alt='Leg-Style Crab Flavoured Wild Alaska Pollock and Wild Pacific Whiting' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="20749798_EA">
      <input type="checkbox" class="toggle-input" id="toggle-20749798_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-20749798_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#7</span>
            <span class="first-word">Leg-Style</span>
            <span class="product-name-text">Crab Flavoured Wild Alaska Pollock and Wild Pacific Whiting</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 3.99</span></div>
          <div class="now-price">NOW: $ 2.99</div>
          <div class="discount-badge">25.1% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-20749798_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="20699832_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/20699832/b3/en/angle/20699832_angle_a06_@2.png' alt='Flake-Style Crab Flavoured Wild Alaska Pollock and Wild Pacific Whiting' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="20699832_EA">
      <input type="checkbox" class="toggle-input" id="toggle-20699832_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-20699832_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#8</span>
            <span class="first-word">Flake-Style</span>
            <span class="product-name-text">Crab Flavoured Wild Alaska Pollock and Wild Pacific Whiting</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 3.99</span></div>
          <div class="now-price">NOW: $ 2.99</div>
          <div class="discount-badge">25.1% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-20699832_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>

<div class="item-container" data-product-id="21108887_EA">
  
  <div class="left-side">
    <div class="item-image">
      <img src='https://assets.shop.loblaws.ca/products/21108887/b3/en/angle/21108887_angle_a06_@2.png' alt='Breaded Cod Bites With Sauce' />
    </div>
    <!-- "On Sale" button (Detail) -->
    <button class="vertical-switch-button selected fade-on-load" data-type="detail" onclick="switchToDetail(this)">On Sale</button>
    <!-- Toggle switch -->
    <div class="toggle-switch disabled" data-product-id="21108887_EA">
      <input type="checkbox" class="toggle-input" id="toggle-21108887_EA" onchange="toggleMonYr(this)">
      <label class="toggle-label" for="toggle-21108887_EA">
        <span class="toggle-circle"></span>
        <span class="toggle-text">1 Yr</span>
      </label>
    </div>
  </div>
        
  
  <div class="right-side">
    <div class="view-container">
      <div class="detail-view fade-in">
        
          <div class="item-name">
            <span class="item-number">#9</span>
            <span class="first-word">Breaded</span>
            <span class="product-name-text">Cod Bites With Sauce</span>
          </div>
          <div>Expire On: 2025-03-05</div>
          <div>WAS: <span class="was-price">$ 10.99</span></div>
          <div class="now-price">NOW: $ 9.99</div>
          <div class="discount-badge">9.1% OFF</div>
        
      </div>
      <div class="chart-view fade-out" id="chart-21108887_EA">
        <!-- Canvas will be injected here by Chart.js -->
      </div>
    </div>
  </div>
        
</div>


<script>
function showSearchBar() {
    var header = document.querySelector('.header-container');
    header.style.display = 'none';
    var searchBar = document.getElementById('searchBarContainer');
    searchBar.style.display = 'flex';
    setTimeout(function() {
        searchBar.style.opacity = '1';
    }, 10);
    document.getElementById('searchInput').focus();
}

function hideSearchBar() {
    var searchBar = document.getElementById('searchBarContainer');
    var header = document.querySelector('.header-container');
    var searchInput = document.getElementById('searchInput');
    searchInput.value = '';
    var firstElems = document.getElementsByClassName('first-word');
    var secondElems = document.getElementsByClassName('product-name-text');
    for (var i = 0; i < firstElems.length; i++) {
        firstElems[i].innerHTML = firstElems[i].dataset.original || firstElems[i].innerHTML;
    }
    for (var i = 0; i < secondElems.length; i++) {
        secondElems[i].innerHTML = secondElems[i].dataset.original || secondElems[i].innerHTML;
    }
    var items = document.getElementsByClassName('item-container');
    for (var i = 0; i < items.length; i++) {
        items[i].style.display = "";
    }
    document.getElementById('searchCount').innerText = "";
    searchBar.style.opacity = '0';
    setTimeout(function() {
        searchBar.style.display = 'none';
        header.style.display = 'flex';
    }, 500);
}

function inPageSearch() {
    var input = document.getElementById('searchInput').value.trim();
    var term = input.toLowerCase();
    var items = document.getElementsByClassName('item-container');
    var visibleCount = 0;
    for (var i = 0; i < items.length; i++) {
        var firstElem = items[i].querySelector('.first-word');
        var secondElem = items[i].querySelector('.product-name-text');
        var fullName = (firstElem.textContent + ' ' + secondElem.textContent).toLowerCase();
        if (term === '' || fullName.indexOf(term) > -1) {
            items[i].style.display = '';
            visibleCount++;
            if (term !== '') {
                firstElem.innerHTML = (firstElem.dataset.original || firstElem.textContent).replace(new RegExp('('+term+')', 'gi'), '<mark>$1</mark>');
                secondElem.innerHTML = (secondElem.dataset.original || secondElem.textContent).replace(new RegExp('('+term+')', 'gi'), '<mark>$1</mark>');
            } else {
                firstElem.innerHTML = firstElem.dataset.original || firstElem.innerHTML;
                secondElem.innerHTML = secondElem.dataset.original || secondElem.innerHTML;
            }
        } else {
            items[i].style.display = 'none';
        }
    }
    document.getElementById('searchCount').innerText = visibleCount + " found";
}
</script>

</body>
</html>
